# vim:filetype=sh
# bash init string when entering new bash session (e.g. either by ssh or sudo,
# or a system call inside of vim)
#
# you can customize the environment by pre-defining a function called
# ESH_BASH_INIT
#
_bash_init() {
  # Args:
  #   p is the communication port
  local ESH_STY=$1 p=$2
  #declare -p $(compgen -v ESH_)
  declare -p ESH_AT ESH_TMP ESH_STY ESH_USER
  declare -f _esh_e _esh_b _esh_l _esh_i
  #[ $# = 1 ] && return
  printf 'ESH_PORT=%s _esh_i %s ESH_PORT </dev/null\n' $p $ESH_STY
  if declare -f ESH_BASH_INIT; then
    echo 'ESH_BASH_INIT'
  fi
  echo 'exec bash --norc --noprofile'
}
export -f _bash_init
